# One Hub æœ¬åœ°å¼€å‘ç¯å¢ƒé…ç½®æŒ‡å—

## ğŸ¯ å¼€å‘ç¯å¢ƒæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æœ¬åœ°å¼€å‘ç¯å¢ƒ                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å‰ç«¯ (React + Vite)     â”‚  åç«¯ (Go + Gin)                â”‚
â”‚  ç«¯å£: 3010              â”‚  ç«¯å£: 3000                      â”‚
â”‚  URL: localhost:3010     â”‚  API: localhost:3000/api        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                Docker Compose æœåŠ¡                          â”‚
â”‚  MySQL: 3306            â”‚  Redis: 6379                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ ç¯å¢ƒè¦æ±‚

### å¿…éœ€è½¯ä»¶
- **Docker** & **Docker Compose** - æ•°æ®åº“æœåŠ¡
- **Go 1.19+** - åç«¯å¼€å‘
- **Node.js 16+** - å‰ç«¯å¼€å‘  
- **Yarn** - å‰ç«¯åŒ…ç®¡ç†

### æ£€æŸ¥å®‰è£…
```bash
docker --version
docker compose version  # æˆ– docker-compose --version
go version
node --version
yarn --version
```

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### ä¸€é”®å¯åŠ¨ (æ¨è)
```bash
# Linux/macOS
./dev-start.sh start

# Windows
dev-start.bat start
```

### æ‰‹åŠ¨å¯åŠ¨
```bash
# 1. å¯åŠ¨æ•°æ®åº“æœåŠ¡
docker compose -f docker-compose-dev.yml up -d

# 2. å¯åŠ¨åç«¯ (æ–°ç»ˆç«¯)
go build -o tmp/one-hub-dev main.go
./tmp/one-hub-dev --config config-dev.yaml

# 3. å¯åŠ¨å‰ç«¯ (æ–°ç»ˆç«¯)
cd web
yarn install  # é¦–æ¬¡è¿è¡Œ
yarn dev
```

## ğŸ› ï¸ å¼€å‘ç¯å¢ƒç®¡ç†

### å¯åŠ¨è„šæœ¬å‘½ä»¤
```bash
./dev-start.sh start    # å¯åŠ¨å®Œæ•´å¼€å‘ç¯å¢ƒ
./dev-start.sh stop     # åœæ­¢æ‰€æœ‰æœåŠ¡
./dev-start.sh restart  # é‡å¯æ‰€æœ‰æœåŠ¡
./dev-start.sh status   # æŸ¥çœ‹æœåŠ¡çŠ¶æ€
```

### æœåŠ¡è®¿é—®åœ°å€
- **å¼€å‘ç¯å¢ƒ**: http://localhost:3010 (å‰ç«¯ + API ä»£ç†)
- **åç«¯ API**: http://localhost:3000 (ç›´æ¥è®¿é—®)
- **MySQL**: localhost:3306 (ç”¨æˆ·å: oneapi, å¯†ç : 123456)
- **Redis**: localhost:6379

## ğŸ“ é¡¹ç›®ç»“æ„

```
one-hub/
â”œâ”€â”€ docker-compose-dev.yml    # å¼€å‘ç¯å¢ƒæ•°æ®åº“é…ç½®
â”œâ”€â”€ config-dev.yaml          # å¼€å‘ç¯å¢ƒåç«¯é…ç½®
â”œâ”€â”€ dev-start.sh            # Linux/macOS å¯åŠ¨è„šæœ¬
â”œâ”€â”€ dev-start.bat           # Windows å¯åŠ¨è„šæœ¬
â”œâ”€â”€ DEV-SETUP.md           # æœ¬æ–‡æ¡£
â”œâ”€â”€ web/                   # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ vite.config.mjs   # Vite é…ç½® (åŒ…å« API ä»£ç†)
â”‚   â””â”€â”€ package.json      # å‰ç«¯ä¾èµ–
â”œâ”€â”€ logs/                 # å¼€å‘æ—¥å¿—
â”œâ”€â”€ tmp/                  # ä¸´æ—¶æ–‡ä»¶å’Œ PID
â””â”€â”€ cache/               # ç¼“å­˜ç›®å½•
```

## ğŸ”§ é…ç½®è¯´æ˜

### æ•°æ®åº“é…ç½® (docker-compose-dev.yml)
- **MySQL 8.2.0**: å¼€å‘ä¸“ç”¨å®ä¾‹
- **Redis**: ç¼“å­˜æœåŠ¡
- **æ•°æ®æŒä¹…åŒ–**: `./data/mysql-dev/`
- **ç½‘ç»œéš”ç¦»**: ç‹¬ç«‹çš„ `one-hub-dev` ç½‘ç»œ

### åç«¯é…ç½® (config-dev.yaml)
- **è°ƒè¯•æ¨¡å¼**: `gin_mode: debug`, `log_level: debug`
- **æ•°æ®åº“è¿æ¥**: è¿æ¥æœ¬åœ° Docker MySQL
- **Redis è¿æ¥**: è¿æ¥æœ¬åœ° Docker Redis
- **å¼€å‘ä¼˜åŒ–**: æ”¾å®½é€Ÿç‡é™åˆ¶ï¼Œå¯ç”¨å†…å­˜ç¼“å­˜

### å‰ç«¯é…ç½® (web/vite.config.mjs)
- **å¼€å‘ç«¯å£**: 3010
- **API ä»£ç†**: `/api` è¯·æ±‚ä»£ç†åˆ° `http://127.0.0.1:3000`
- **çƒ­é‡è½½**: è‡ªåŠ¨åˆ·æ–°å’Œæ¨¡å—çƒ­æ›¿æ¢

## ğŸ› å¸¸è§é—®é¢˜

### 1. ç«¯å£å†²çª
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i :3000  # åç«¯ç«¯å£
lsof -i :3010  # å‰ç«¯ç«¯å£
lsof -i :3306  # MySQL ç«¯å£
lsof -i :6379  # Redis ç«¯å£

# åœæ­¢å ç”¨è¿›ç¨‹
kill -9 <PID>
```

### 2. æ•°æ®åº“è¿æ¥å¤±è´¥
```bash
# æ£€æŸ¥ MySQL å®¹å™¨çŠ¶æ€
docker ps | grep mysql-dev

# æŸ¥çœ‹ MySQL æ—¥å¿—
docker logs mysql-dev

# é‡å¯æ•°æ®åº“æœåŠ¡
docker compose -f docker-compose-dev.yml restart mysql-dev
```

### 3. å‰ç«¯ä¾èµ–é—®é¢˜
```bash
cd web
rm -rf node_modules yarn.lock
yarn install
```

### 4. åç«¯æ„å»ºå¤±è´¥
```bash
# æ¸…ç† Go æ¨¡å—ç¼“å­˜
go clean -modcache
go mod download
go mod tidy
```

## ğŸ“Š å¼€å‘å·¥ä½œæµ

### 1. æ—¥å¸¸å¼€å‘
```bash
# å¯åŠ¨å¼€å‘ç¯å¢ƒ
./dev-start.sh start

# è®¿é—®åº”ç”¨
open http://localhost:3010

# æŸ¥çœ‹æ—¥å¿—
tail -f logs/backend-dev.log   # åç«¯æ—¥å¿—
tail -f logs/frontend-dev.log  # å‰ç«¯æ—¥å¿—
```

### 2. ä»£ç ä¿®æ”¹
- **å‰ç«¯**: ä¿å­˜åè‡ªåŠ¨çƒ­é‡è½½
- **åç«¯**: éœ€è¦é‡å¯åç«¯æœåŠ¡
  ```bash
  # ä»…é‡å¯åç«¯
  pkill -f one-hub-dev
  go build -o tmp/one-hub-dev main.go
  ./tmp/one-hub-dev --config config-dev.yaml &
  ```

### 3. æ•°æ®åº“æ“ä½œ
```bash
# è¿æ¥ MySQL
docker exec -it mysql-dev mysql -u oneapi -p one-api

# è¿æ¥ Redis
docker exec -it redis-dev redis-cli
```

## ğŸ”„ ä¸ç”Ÿäº§ç¯å¢ƒçš„å·®å¼‚

| é¡¹ç›® | å¼€å‘ç¯å¢ƒ | ç”Ÿäº§ç¯å¢ƒ |
|------|----------|----------|
| å‰ç«¯æœåŠ¡ | Vite å¼€å‘æœåŠ¡å™¨ (3010) | åµŒå…¥åˆ° Go äºŒè¿›åˆ¶ |
| åç«¯é…ç½® | debug æ¨¡å¼ï¼Œè¯¦ç»†æ—¥å¿— | release æ¨¡å¼ |
| æ•°æ®åº“ | æœ¬åœ° Docker MySQL | å¤–éƒ¨ MySQL æœåŠ¡ |
| è®¿é—®æ–¹å¼ | localhost:3010 | ç»Ÿä¸€ç«¯å£ 3000 |
| è·¨åŸŸå¤„ç† | Vite ä»£ç† | æ— éœ€å¤„ç† |

## ğŸ§ª æµ‹è¯•å»ºè®®

### API æµ‹è¯•
```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:3000/api/status

# é€šè¿‡å‰ç«¯ä»£ç†è®¿é—®
curl http://localhost:3010/api/status
```

### å‰ç«¯æµ‹è¯•
- è®¿é—® http://localhost:3010
- æ£€æŸ¥æµè§ˆå™¨å¼€å‘è€…å·¥å…·ç½‘ç»œé¢æ¿
- ç¡®è®¤ API è¯·æ±‚æ­£ç¡®ä»£ç†åˆ°åç«¯

## ğŸ“ å¼€å‘æ³¨æ„äº‹é¡¹

1. **é…ç½®æ–‡ä»¶**: ä¸è¦æäº¤ `config-dev.yaml` ä¸­çš„æ•æ„Ÿä¿¡æ¯
2. **æ•°æ®æŒä¹…åŒ–**: å¼€å‘æ•°æ®å­˜å‚¨åœ¨ `./data/mysql-dev/`
3. **æ—¥å¿—æ–‡ä»¶**: å®šæœŸæ¸…ç† `logs/` ç›®å½•ä¸‹çš„æ—¥å¿—æ–‡ä»¶
4. **ç¼“å­˜ç›®å½•**: `cache/` ç›®å½•å¯ä»¥å®‰å…¨åˆ é™¤é‡å»º
5. **è·¨åŸŸé—®é¢˜**: å¼€å‘ç¯å¢ƒé€šè¿‡ Vite ä»£ç†è§£å†³ï¼Œç”Ÿäº§ç¯å¢ƒæ— æ­¤é—®é¢˜

## ğŸ†˜ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æ£€æŸ¥ `logs/` ç›®å½•ä¸‹çš„æ—¥å¿—æ–‡ä»¶
2. è¿è¡Œ `./dev-start.sh status` æŸ¥çœ‹æœåŠ¡çŠ¶æ€
3. æŸ¥çœ‹ Docker å®¹å™¨æ—¥å¿—: `docker logs <container_name>`
4. é‡å¯å¼€å‘ç¯å¢ƒ: `./dev-start.sh restart`
