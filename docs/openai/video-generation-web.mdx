---
title: "视频生成（网页版渠道）"
description: "通过 kapon 的 OpenAI 兼容接口，调用上游网页版类渠道的 Sora-2/Sora-2-Pro 视频生成"
openapi: "POST /v1/videos"
---

本页介绍基于“OpenAI 网页版渠道”类型的 Sora 视频生成用法。该类型渠道在 kapon 中“完全兼容 OpenAI API 标准”，接口仍为 `/v1/videos`，请求/响应字段与官方保持一致。与官方 OpenAI API 通道不同的是，网页版渠道的时长与参考图参数有差异：

- 时长（seconds）
  - `sora-2`：支持 10 秒、15 秒
  - `sora-2-pro`：支持 15 秒、25 秒
- 参考图传参：推荐使用“参考图 URL”的方式（`input_image` 或 `input_images`）。

网关保持 OpenAI 兼容的 `/v1/videos` 接口不变，内部会自动将参考图 URL 转换为上游 `image_urls` 并执行任务。

## 创建视频任务（参考图 URL）

使用 JSON 传入参考图 URL：

```bash
curl -X POST "https://models.kapon.cloud/v1/videos" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "sora-2",
    "prompt": "百事可乐宣传片",
    "seconds": "10",
    "size": "720x1280",
    "input_image": "https://example.com/ref.jpg"
  }'
```

或传入多张 URL：

```bash
curl -X POST "https://models.kapon.cloud/v1/videos" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "sora-2",
    "prompt": "百事可乐宣传片",
    "seconds": "10",
    "size": "720x1280",
    "input_images": [
      "https://example.com/ref-1.jpg",
      "https://example.com/ref-2.png"
    ]
  }'
```

<Callout type="warning">
请按渠道选择合法时长：`sora-2` 仅 10/15 秒，`sora-2-pro` 仅 15/25 秒。若传入不支持的秒数将直接被拒绝。
</Callout>

### 参数说明

- `model`：`sora-2` 或 `sora-2-pro`
- `prompt`：视频生成的文本描述
- `seconds`：视频时长（字符串传递更兼容）。
  - `sora-2`：10、15
  - `sora-2-pro`：15、25
- `size`：分辨率，如 `1280x720`、`720x1280`
- `input_image`：单个参考图 URL（http/https 或 base64），推荐使用
- `input_images`：多个参考图 URL（数组）

### 响应示例

```json
{
  "id": "task_01K9SPR345CQG93AQCEB8G2STH",
  "object": "video",
  "created_at": 1762873052,
  "status": "queued",
  "model": "sora-2",
  "prompt": "百事可乐宣传片",
  "progress": 0,
  "seconds": "10",
  "size": "720x1280"
}
```

## 状态说明

- `queued`：任务已排队
- `processing`：生成中（会伴随 `progress` 进度）
- `completed`：完成，可下载
- `failed`：失败

<Callout type="info">
网页版渠道任务以 OpenAI 兼容格式返回；任务查询（`GET /v1/videos/{id}`）在完成后会包含视频下载地址（video_url），你也可以直接使用 `/v1/videos/{id}/content` 下载视频内容。
</Callout>

## 完整示例

```bash
# 1) 创建任务
RESP=$(curl -sS -X POST "https://models.kapon.cloud/v1/videos" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "sora-2",
    "prompt": "百事可乐宣传片",
    "seconds": "10",
    "size": "720x1280",
    "input_image": "https://example.com/ref.jpg"
  }')

VIDEO_ID=$(echo "$RESP" | jq -r '.id')
echo "任务 ID: $VIDEO_ID"

# 2) 轮询
while true; do
  R=$(curl -sS "https://models.kapon.cloud/v1/videos/$VIDEO_ID" \
    -H "Authorization: Bearer $TOKEN")
  STATUS=$(echo "$R" | jq -r '.status')
  PROG=$(echo "$R" | jq -r '.progress')
  echo "状态: $STATUS 进度: ${PROG}%"
  if [ "$STATUS" = "completed" ]; then
    break
  elif [ "$STATUS" = "failed" ]; then
    echo "✗ 生成失败"; exit 1
  fi
  sleep 2
done

# 3) 下载视频
curl -L "https://models.kapon.cloud/v1/videos/$VIDEO_ID/content" \
  -H "Authorization: Bearer $TOKEN" \
  -o "${VIDEO_ID}.mp4"
echo "✓ 已保存到 ${VIDEO_ID}.mp4"
```

## SDK 示例（Python）

```python
from openai import OpenAI
client = OpenAI(base_url="https://models.kapon.cloud/v1", api_key="$TOKEN")

job = client.videos.create(
    model="sora-2",
    prompt="百事可乐宣传片",
    seconds="10",
    size="720x1280",
    # 通过 extra_body 传递参考图 URL（由网关映射为上游 image_urls）
    extra_body={"input_image": "https://example.com/ref.jpg"},
)
print(job.id, job.status)

# 轮询与下载同前
```

<Callout type="tip">
若你只有本地文件而非 URL，也可以使用 `multipart/form-data` 的 `input_reference` 上传参考图。网关会将图片镜像到 S3/CDN 并转为 URL 再提交给上游。
</Callout>

### 脚本示例（Python，参考图 URL）

仓库已提供可直接运行的脚本，基于 openai SDK 通过 `input_image` URL 发起任务并下载成片：

```bash
export OPENAI_BASE_URL="https://models.kapon.cloud/v1"
export OPENAI_API_KEY="$TOKEN"

python3 scripts/sora2_image_to_video_url_sdk.py \
  --image-url "https://example.com/ref.jpg" \
  --prompt "百事可乐宣传片" \
  --seconds 10 \
  --size 720x1280 \
  --output sora_image2video.mp4
```
